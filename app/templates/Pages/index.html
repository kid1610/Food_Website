
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Kimi is a curated foods and beverages artisans.">
    <meta name="author" content="Philip Herlambang">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">


    <meta name="twitter:card" content="summary">
    <meta name="title" content="Back to Kimi">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="en-id">


    <!-- open graph metadata facebook, slack, whatsapp line -->
    <meta property="fb:app_id" content="150112802189143"/>
    <meta property="og:locale" content="en_US" />
    <meta property="og:title" content="Back to Kimi" />
    <meta property='og:site_name' content='Kimi | Curated Foods and Beverages' />
    <meta property="og:url" content="http://kimistatic.s3-website-ap-southeast-1.amazonaws.com/" />
    <meta property="og:description" content="Kimi is a curated foods and beverages artisans." />
    <meta property='og:image' content="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/apple-touch-icon.png" />


    <!-- open graph metadata twitter -->
    <meta name="twitter:title" content="Back to Kimi">
    <meta name="twitter:url" content="http://www.backtokimi.com">
    <meta name="twitter:description" content="Kimi is a curated foods and beverages artisans.">
    <meta name="twitter:image" content="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/apple-touch-icon.png">
    <meta name="twitter:site" content="@backtokimi">


    <link rel="icon" href="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/apple-touch-icon.png">

    <title>Kimi Themes</title>

    <!-- Bootstrap -->
    <link href="{{ url_for('static',filename='css/bootstrap.min.css')}}" rel="stylesheet">
    <link href="{{ url_for('static',filename='css/kimi.css')}}" rel="stylesheet">
    <link href="{{ url_for('static',filename='css/font-awesome.min.css')}}" rel="stylesheet">

    <!-- owl carousel -->
    <link rel="stylesheet" href="{{ url_for('static',filename='css/owl_carousel/owl.carousel.css')}}">
    <link rel="stylesheet" href="{{ url_for('static',filename='css/owl_carousel/owl.theme.default.css')}}">

    <!--tipue search-->
    <link rel="stylesheet" href="{{ url_for('static',filename='css/tipuesearch/tipuesearch.css')}}">

    <link rel="stylesheet" href="{{ url_for('static',filename='css/prism/prism.css')}}">

    <style>
        a::after {
          content: none;
        }
        </style>
</head>

<body>

<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid hidden-xs">
        <div class="row">
            <div class="col-md-4 col-sm-4">
                <button class="pull-left search-button" id="buttonOpenSearchbar"><i class="fa fa-search" aria-hidden="true"></i></button>
                <button class="pull-left search-button hide" id="buttonCloseSearchbar"><i class="fa fa-times" aria-hidden="true"></i></button>

                <div id="searchbar" class="hide">
                    <div>
                        <div class="top-nav-searchbar">
                            <div class="input-group">
                                <form action="search.html">
                                    <input class="form-control" type="text" name="q" id="tipue_search_input" placeholder="Search for" autofocus="autofocus">
                                </form>
                            </div><!-- /input-group -->
                        </div>
                    </div>
                </div>
                <p class="help-text hidden-sm hidden-md" id="helpText">Bạn muốn tìm kiếm gì? || Phản hồi dịch vụ qua<a href="mailto: Kimi@gmail.com" class="text-secondary">Kimi@gmail.com</a> </p>
            </div>
            <div class="col-md-4 col-sm-4">
                <p class="text-center logo-container"><a href="index.html"><img src="{{ url_for('static',filename='images/logo.png')}}" width="100"></a></p>
            </div>
            <div class="col-md-4 less-padding-right">
                <a href="registerMerchant.html" class="btn pull-right button-green-top-nav">Hãy là thành viên với Kimi</a>
            </div>
        </div>
    </div>

    <div class="container-fluid bg-white">
        <div class="navbar-header pull-left">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar icon-short"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar icon-medium"></span>
            </button>
        </div>
        <div class="visible-xs logo-center">
            <p class="text-center logo-container visible-xs"><a href="index.html"><img src="{{ url_for('static',filename='images/logo.png')}}" width="90"></a></p>
        </div>
        <div class="visible-xs pull-right">
            <button class="pull-left search-button-mobile" id="buttonOpenSearchbarMobile"><i class="fa fa-search" aria-hidden="true"></i></button>
        </div>
        <div class="clearfix"></div>

        <div class="fly-searchbar" style="display: none;">
            <div class="top-nav-searchbar searchbar-mobile">
                <div class="input-group">
                    <form action="search.html">
                        <input class="form-control" type="text" name="q" id="tipue_search_input" placeholder="Search for" autofocus="autofocus">
                    </form>
                    <button class="pull-right" id="buttonCloseSearchbarMobile"><i class="fa fa-times" aria-hidden="true"></i></button>
                </div>
            </div>
        </div>


        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="./">Shop</a></li>
                <li><a href="./articles">Articles</a></li>
                <li><a href="./merchantGuide">Chef Guide</a></li>
                <li class="dropdown">
                    <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Location <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="chefDirectory.html">Hải Châu</a></li>
                        <li><a href="chefDirectory.html">Sơn Trà</a></li>
                        <li><a href="chefDirectory.html">Liên Chiểu</a></li>
                        <li><a href="chefDirectory.html">Cẩm Lệ</a></li>
                        <li><a href="chefDirectory.html">Ngũ Hành Sơn</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="chefDirectory.html">Đà Nẵng</a></li>
                        <li><a href="chefDirectory.html">Việt Nam</a></li>
                    </ul>
                </li>
                <li><a href="./questions">FAQs</a></li>
                <li><a href="./about">About</a></li>
                <li><a href="./contact">Contact Us</a></li>
                <li><a href="./chefDirectory">Chef Directory</a></li>
                <li><a href="./login">Login / Register</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" id = "cart_quantity" >Cart({{num_of_product}})</a>
                    <ul class="dropdown-menu">
                        <li>
                            <form action='/addcart' method="post">
                                <div class="cart-flyout"  id = "product_list">
                                    <h4 class="text-oswald">Recently Added Product(s)</h4>
                                    {% set total = [0] %}
                                    {%for prod in cart_list%}
                                    <div class="row">
                                        <div class="col-sm-2 col-xs-3 less-padding">
                                            <img src={{prod["image_link"]}} width="100%">
                                        </div>
                                        <div class="col-sm-8 col-xs-9">
                                            <span class="text-gray-1">{{prod["product_name"]}}</span>
                                            <p class="text-gray-2">{{prod["quantity"]}} x {{prod["price"]}}</p>
                                            {% set _ = total.append(total.pop() + prod["price"]|int*prod["quantity"]|int) %}
                                        </div>
                                    </div>
                                    {% endfor %}
                                    <hr>
                                    <div id = "index_insert"></div>
                                    <hr>                               
                                    <div class="row">                                   
                                        <div class="col-sm-6 col-xs-6 less-padding"><h4><small>Total</small><br><span id = "total">{{total[0]}} VND</span></h4></div>
                                        <div class="col-sm-6 col-xs-6 less-padding">
                                            <a href="./shoppingcart" class="button-green-top-nav btn pull-right btn-block text-oswald text-uppercase">View Cart</a>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>


<div class="container-fluid kimi-container less-padding">
    <div class="homepage-slider owl-carousel owl-theme">
        <div class="item">
            <div class="scrim"></div>
            <h2 class="heading-large"> Thức ăn ngon càng ngọt ngào hơn khi được chia sẻ với những người bạn tốt</h2>
            <div class="row-buttons">
                <a href="channelDetail.html" class="btn button-outline text-white"> Ghé thăm cửa hàng</a>
                <a href="articleDetails.html" class="btn button-outline text-white"> Xem bài viết</a>
                <a href="#" class="btn button-outline text-white"> Bộ sưu tập</a>
            </div>
            <img src="{{ url_for('static',filename='images/slider1.jpg')}}" width="100%">
        </div>
        <div class="item">
            <div class="scrim"></div>
            <h2 class="heading-large"> Làm mới ngày của bạn, làm mới tâm trạng của bạn, sảng khoái với bữa ăn ngon này</h2>
            <div class="row-buttons">
                <a href="channelDetail.html" class="btn button-outline text-white"> Ghé thăm cửa hàng</a>
                <a href="articleDetails.html.html" class="btn button-outline text-white"> Xem bài viết</a>
                <a href="#" class="btn button-outline text-white">Bộ sưu tập</a>
            </div>
            <img src="{{ url_for('static',filename='images/slider2.jpg')}}" width="100%">
        </div>
        <div class="item">
            <div class="scrim"></div>
            <h2 class="heading-large">Bạn đã bao giờ có một món ăn hoặc đồ uống nào khiến bạn cảm thấy hoàn toàn hài lòng chưa?</h2>
            <div class="row-buttons">
                <a href="channelDetail.html" class="btn button-outline text-white"> Ghé thăm cửa hàng</a>
                <a href="articleDetails.html" class="btn button-outline text-white"> Xem bài viết</a>
                <a href="#" class="btn button-outline text-white"> Bộ sưu tập</a>
            </div>
            <img src="{{ url_for('static',filename='images/slider3.jpg')}}" width="100%">
        </div>
    </div>
</div>

<div class="clearfix maya-tiny-padding"></div>
<div class="container">
    <div class="">
        <div class="clearfix"></div>
        <div class="row">
            <h2 class="default-userProductList-InfoBar-title text-center"><i class="fa fa-heart-o" aria-hidden="true"></i> Món ăn yêu thích</h2>
                {%for product in product_list%}
                    <!-- <form method="post" action="{{url_for('cart_module.addcart',product_name=product[1])}}">              -->
                        <div class="col-sm-6 col-md-4" data-behavior="sample_code">
                            <a href="./productDetail/{{product[1]}}" class="thumbnail_item thumbnail less-padding less-margin">
                                <img src={{product[5]}} >
                            </a>
                            <div class="caption box">
                                <h3 name = 'product_name'><span  name="product_name">{{product[1]}}</span></h3>
                                <div class="row">
                                    <div class="col-sm-8 col-xs-6">
                                        <p class="default-userProductList-CardList-price"> {{product[2]}} VNĐ</p>
                                        <span class="min-order">Miễn phí giao hàng với {{product[3]}} cái</span>
                                    </div>
                                    {% set product_name = product[1] %}
                                    {% set product_price = product[2] %}
                                    {% set image_link = product[5] %}
                                    <div class="col-sm-4 col-xs-6">

                                        <!-- <a href="{{url_for('cart_module.addcart',product_name=product[1])}}" class="btn default-userProductList-CardList-button pull-right" >Add to Cart</a> -->
                                        
                                        <button onclick="myFunction('{{product[5]}}', '{{product[1]}}', '{{product[2]}}')" class="btn default-userProductList-CardList-button pull-right">Thêm vào giỏ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <!-- </form> -->
                {%endfor%}
        </div>
    </div>

    <div class="row" id="navigation">
        <ul class="pagination">
            <div class="product-detail-tag-container col-md-12 text-center">
                <ul class="pagination">
                    {%for i in range(1,page_limit+1)%}
                    <li class="page-item"><a class="page-link" href="{{url_for('index_module.index',page=i)}}">{{i}}</a></li>
                    {%endfor%}
                </ul>
            </div>
        </ul>
    </div>
    <style type="text/css">
        #navigation {
            text-align: center;
        }
        #navigation ul {
            display: inline-block;
            margin: 0;
            padding: 0;
            /* For IE, the outcast */
            zoom:1;
            *display: inline;
        }

        #navigation li {
            float: left;
            padding: 2px 5px;
        }
    </style>
    <div class="row">
        <div class="col-md-2 col-md-offset-1">
            <p class="text-center">
                <img src="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/svg/pilih_menu.svg" width="120" />
                <h5 class="text-roboto text-center">Chọn thực đơn bạn muốn</h5>
            </p>
        </div>
        <div class="col-md-2">
            <p class="text-center">
                <img src="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/svg/atur_jadwal.svg" width="120" />
                <h5 class="text-roboto text-center">Đặt lịch trình và địa chỉ giao hàng</h5>
            </p>
        </div>
        <div class="col-md-2">
            <p class="text-center">
                <img src="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/svg/approval.svg" width="120" />
                <h5 class="text-roboto text-center">Xác nhận đơn hàng</h5>  
            </p>
        </div>
        <div class="col-md-2">
            <p class="text-center">
                <img src="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/svg/pay.svg" width="120" />
                <h5 class="text-roboto text-center">Thanh toán</h5>
            </p>
        </div>
        <div class="col-md-2">
            <p class="text-center">
                <img src="https://s3-ap-southeast-1.amazonaws.com/kimistatic/images/svg/nikmati.svg" width="120" />
                <h5 class="text-roboto text-center">Thưởng thức món ăn tuyệt vời từ Kimi</h5>    
            </p>
        </div>
    </div>

</div><!-- /.container -->

<div class="clearfix maya-tiny-padding"></div>
<div class="container mobile-full-width-slider">
    <h2 class="default-userProductList-InfoBar-title text-center"><i class="fa fa-heart-o" aria-hidden="true"></i>Thương hiệu nổi tiếng</h2>
    <div class="featured-merchant-slider owl-carousel owl-theme">
        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>Sucicakes</p>-->
            <img src="{{ url_for('static',filename='images/sucicakes_logo.png')}}" class="img-rounded" width="100%">
        </div>

        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>Nasi Bakar 58</p>-->
            <img src="{{ url_for('static',filename='images/nasi_bakar_logo.jpg')}}" class="img-rounded" width="100%">
        </div>

        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>LL Ball</p>-->
            <img src="{{ url_for('static',filename='images/llball_logo.JPG')}}" class="img-rounded" width="100%">
        </div>

        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>LL Ball</p>-->
            <img src="{{ url_for('static',filename='images/deliciozo_logo.jpg')}}" class="img-rounded" width="100%">
        </div>

        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>LL Ball</p>-->
            <img src="{{ url_for('static',filename='images/bakmi_48_logo.jpg')}}" class="img-rounded" width="100%">
        </div>

        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>LL Ball</p>-->
            <img src="{{ url_for('static',filename='images/llball_logo.JPG')}}" class="img-rounded" width="100%">
        </div>

        <div class="item">
            <!--<div class="scrim"></div>-->
            <!--<p>LL Ball</p>-->
            <img src="{{ url_for('static',filename='images/fans_logo.png')}}" class="img-rounded" width="100%">
        </div>

    </div>
</div>
<div class="clearfix maya-small-padding"></div>




<!--include footer-->
<div class="include-footer"></div>


<script src="{{ url_for('static',filename='js/jquery.min.js')}}"></script>

<!-- owl carousel -->
<script src="{{ url_for('static',filename='js/owl_carousel/owl.carousel.js')}}"></script>

<!--boostrap js-->
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="{{ url_for('static',filename='js/bootstrap.min.js')}}"></script>

<!--tipuesearch-->
<script src="{{ url_for('static',filename='js/tipusearch/tipuesearch_content.js')}}"></script>
<script src="{{ url_for('static',filename='js/tipusearch/tipuesearch_set.js')}}"></script>
<script src="{{ url_for('static',filename='js/tipusearch/tipuesearch.js')}}"></script>

<script src="{{ url_for('static',filename='js/prism/prism.js')}}"></script>

<!--kimi basic js-->
<script src="{{ url_for('static',filename='js/kimi.js')}}"></script>

<script>
    function myFunction(image_link, product_name, product_price) {
    
    const parentDiv = document.createElement("div")
    parentDiv.className = "row"
    parentDiv.id = `product_${product_name}`
    
    const newDiv1 = document.createElement("div")
    newDiv1.className = "col-sm-4 col-xs-3 less-padding"
    newDiv1.style.height = "100px";
    newDiv1.style.display = "flex";
    newDiv1.style.alignItems = "center";
    newDiv1.style.objectFit = "contain";

    const img  = document.createElement("img");
    img.src = image_link
    img.width = 100
    
    newDiv1.appendChild(img)
    

    const newDiv2 = document.createElement("div")
    newDiv2.className = "col-sm-8 col-xs-9"
    newDiv2.style.marginTop = "25px";
    const newspan = document.createElement('span')
    newspan.className = `text-gray-1`;
    newspan.id = `${product_name}`;
    newspan.setAttribute("name","product_name")
    const textspan = document.createTextNode(product_name)
    
    newspan.appendChild(textspan)
    newDiv2.appendChild(newspan)
    
    const newp = document.createElement("p")
    newp.className = `text-gray-2 product_qty`;
    newp.id = `${product_name}_qty`;
    let checkProduct = document.getElementById(`${[product_name]}`);
    let textp = undefined;
    var temp_quantity = 1
    if (checkProduct) {
        let pTagQty = document.getElementById(`${product_name}_qty`);
        let pQty = Number(String(pTagQty.innerText[0]).trim()) + 1;
        textp = document.createTextNode(String(pQty)+"x"+product_price);
        const productWrapper = document.getElementById(`product_${product_name}`);
        productWrapper.remove();
        temp_quantity = pQty
    } else {
        textp = document.createTextNode("1x"+product_price)
    }
    newp.appendChild(textp)

    // newp.setAttribute("class","price")
    
    newDiv2.appendChild(newp)
    
    // newDiv1.appendChild(newspan)
    // newDiv1.appendChild(newp)

    parentDiv.appendChild(newDiv1)
    parentDiv.appendChild(newDiv2)

    let index_insert = document.getElementById("index_insert")
    document.getElementById("product_list").insertBefore(parentDiv,index_insert);
    var text_quantity = document.getElementById("cart_quantity")
    removeAllText(text_quantity)
    let result = countProduct()
    cart_quantity = document.getElementById("cart_quantity")
    text_cart = document.createTextNode("Cart ("+String(result-1)+")")
    cart_quantity.append(text_cart)

    sum = sumProduct()
    total = document.getElementById("total")
    removeAllText(total)
    text_total = document.createTextNode(String(sum)+" VND")
    total.appendChild(text_total)
    // console.log(String(temp_quantity))
    putData(product_name,String(temp_quantity),image_link,product_price)
    }
</script>   


<script>
    function countProduct()
    {
        var count = $('div[id^=product]').length
        return count
    }
</script>

<script>
    function getNumProduct(value)
    {
        fetch('/homepage',{
            method: 'put',
            body: JSON.stringify({
                'num' : value+1
            }),
            headers: {
                'Content-Type': 'application/json'
            }
        })
    }
</script>

<script>
    function removeAllText(element) {

// loop through all the nodes of the element
    var nodes = element.childNodes;

    for(var i = 0; i < nodes.length; i++) {

        var node = nodes[i];

        // if it's a text node, remove it
        if(node.nodeType == Node.TEXT_NODE) {

            node.parentNode.removeChild(node);


            i--; // have to update our incrementor since we just removed a node from childNodes

        } else

        // if it's an element, repeat this process
        if(node.nodeType == Node.ELEMENT_NODE) {

            removeAllText(node);

        }
    }
}
</script>

<script>
    function sumProduct()
    {
        const listPrices = document.querySelectorAll(".product_qty")
        let total = 0
        listPrices.forEach((row) => {
            const rowStr = String(row.innerText).trim();
            const x_position = rowStr.indexOf("x");
            const price = Number(rowStr.slice(x_position+1, rowStr.length));
            const quantity = Number(rowStr[0]);
            total += parseInt(price*quantity, 10);
        })
        return total;
    }

</script>


<script>
    function putData(product_name,quantity,image_link,product_price)
    {
        fetch('/addcart',{
            method: 'put',
            body: JSON.stringify({
                'product_name' : product_name,
                'quantity': Number(quantity),
                'image_link': image_link,
                'price': Number(product_price)
            }),
            headers: {
                'Content-Type': 'application/json'
            }
        })
    }
</script>
</body>
</html>
